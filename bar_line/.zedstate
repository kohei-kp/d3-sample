{"split":"1","session.current":["/phase03.js.03.2"],"session.open":{"/phase03.js.03.2":{"scrollTop":2250.5,"scrollLeft":0,"selection":{"start":{"row":164,"column":0},"end":{"row":164,"column":0}},"lastUse":1411798777012,"undo":[],"redo":[]},"/phase03.js":{"scrollTop":1025,"scrollLeft":0,"selection":{"start":{"row":110,"column":13},"end":{"row":110,"column":13}},"lastUse":1411798409492,"undo":[[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":70,"column":1},"end":{"row":70,"column":2}},"text":"/"}]},{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":70,"column":0},"end":{"row":70,"column":1}},"text":"/"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":71,"column":1},"end":{"row":71,"column":2}},"text":"*"}]},{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":71,"column":0},"end":{"row":71,"column":1}},"text":"/"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":161,"column":2},"end":{"row":161,"column":4}},"text":"\t\t"},{"action":"insertText","range":{"start":{"row":161,"column":2},"end":{"row":162,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":161,"column":2},"end":{"row":162,"column":0}},"text":"\n"}]},{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":161,"column":1},"end":{"row":161,"column":2}},"text":"/"}]},{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":161,"column":0},"end":{"row":161,"column":1}},"text":"/"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":161,"column":0},"end":{"row":161,"column":4}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":161,"column":4},"end":{"row":161,"column":8}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":162,"column":1},"end":{"row":162,"column":2}},"text":"/"}]},{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":162,"column":0},"end":{"row":162,"column":1}},"text":"/"}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":0,"column":0},"end":{"row":176,"column":0}},"nl":"\n","lines":["var svgWidth = 1000, svgHeight = 500, barWidth = 30, offsetX = 30, offsetY = 30, barMargin = 15;","","// svg","var svg = d3.select('#myGraph')","\t.append('svg')","\t.attr({","\t\t'width' : svgWidth, ","\t\t'height' : svgHeight","\t});","","// 棒グラフ","var barGraph;","","// 折れ線グラフ","var lineGraph;","","// X軸、Y軸","var xLine, yLine;","","var xLabel, yLabelL,yLabelR;","","var xLabelList = [\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thr\",\"Fri\",\"Sat\"];","","var yLabelListL = [\"250\", \"500\", \"750\" ,\"1000\"];","","// var URL = \"./data.json\";","var URL = \"http://10.211.55.4/wf-log/log/download2\";","","","// X軸の描画位置表示\t","var xPos = functon (i) { return i * (barWidth + barMargin) + offsetX;};","","","$(function() {","\tvar ajaxTest = function() {","\t\tvar data = \"./data.json\";","\t\td3paint(data);","\t}","","\tvar ajaxData = function() {","      \tvar hostUrl = \"http://10.211.55.4/wf-log/log/download3\";","\t\tvar startDt = $('#startDt').val();","\t\tvar endDt   = $('#endDt').val();","","\t\tif (startDt.length != 8 ||","\t\t    endDt.length != 8) {","\t\t\talert('please input date');","\t\t\treturn 0;","\t\t}","\t\t","\t\t$.ajax({","               \t\turl: hostUrl,","               \t\ttype:'GET',","               \t\tdataType: 'json',","\t\t\tcache: false,","\t\t\tdata: {","\t\t\t\tstartDt : startDt,","\t\t\t\tendDt   : endDt","\t\t\t},","                \ttimeout:10000,","                \tsuccess: function(data) {","\t\t\td3paint(data);","\t\t\treturn data;","        \t        },","                \terror: function(XMLHttpRequest, textStatus, errorThrown) {","                        //\t     alert(textStatus);","                       \t}","              });","\t};","","\tvar d3paint = function(jsonUrl) {","","\t\td3.json(jsonUrl, function (data) {","","\t\t\t// sizeの最大値","\t\t\tvar maxSize = d3.max(data, function(data) {return data.size;});","\t","\t\t\t// size(棒グラフ)用Y軸表示位置計算関数","\t\t\tvar yScaleSize = d3.scale.linear()","\t\t\t\t.domain([0, maxSize])","\t\t\t\t.range([svgHeight - offsetY, offsetY]);","","\t\t\t// cntの最大値","\t\t\tvar maxCnt = d3.max(data, function(data) {return data.cnt;});","","\t\t\t// cnt(折れ線グラフ)用Y軸表示位置計算関数","\t\t\tvar yScaleCnt = d3.scale.linear()","\t\t\t\t.domain([0, maxCnt])","\t\t\t\t.range([svgHeight - offsetY, offsetY]);","","\t\t\t// 棒グラフを初期化","\t\t\tbarGraph = svg","\t\t\t\t\t\t.selectAll(\"rect\")","\t\t\t\t\t\t.data(data);","","\t\t\t// 棒グラフの描写","\t\t\tbarGraph","\t\t\t\t.enter()","\t\t\t\t.append(\"rect\")","\t\t\t\t.attr({","\t\t\t\t\t'x' : function(d, i) { return xPos(d.week);},","\t\t\t\t\t'y' : function(d, i) { return yScaleSize(d.size);},","\t\t\t\t\t'width' : barWidth,","\t\t\t\t\t'height' : function(d, i) { return svgHeight - yScaleSize(d.size) - offsetY;},","\t\t\t\t\t'fill' : \"#FF0000\"","\t\t\t\t});","","\t\t\t// 折れ線グラフの計算メソッド","\t\t\tvar drawLine = d3.svg.line()","\t\t\t\t\t\t\t.x(function(d, i) { return xPos(d.week) + (barWidth / 2); })","\t\t\t\t\t\t\t.y(function(d, i) { return yScaleCnt(d.cnt);});","","\t\t\tlineGraph = svg","\t\t\t\t\t.append(\"path\")","\t\t\t\t\t.attr({","\t\t\t\t\t\t\"d\" : drawLine(data),","\t\t\t\t\t\t\"fill\" : \"none\",","\t\t\t\t\t\t\"stroke\" : \"#0000FF\"","\t\t\t\t});","/*","\t\t\t// X軸のラベル","\t\t\txLine = barGraph","\t\t\t\t.enter()","\t\t\t\t.append(\"text\")","\t\t\t\t.attr({","\t\t\t\t\t'x' : function (d, i) { return xPos(d.week); },","\t\t\t\t\t'y' : function (d, i) { return svgHeight - offsetY + 15 }","\t\t\t\t})","\t\t\t\t.text(function(d, i) {return xLabelList[d.week - 1];});","","\t\t\tvar yAxis = d3.svg.axis()","           \t\t.scale(yScaleSize)","              \t.orient(\"left\")","              \t.ticks(5);","","/*","\t\t\t svg.append(\"g\")","\t\t\t\t\t.attr(\"transform\", \"translate(\" + offsetX + \",0)\")","\t\t\t\t\t.call(yAxis);\t\t","","\t\t\t\t\t.cal(","\t\t\t\t\t\td3.svg.axis()","\t\t\t\t\t\t.scale(yScaleSize)","\t\t\t\t\t\t.orient(\"left\")","\t\t\t\t\t);","*/","/*","\t\t\tyLineL = svg","\t\t\t\t//.selectAll(\"text\")","\t\t\t\t.data(yLabelListL)","\t\t\t\t// .enter()","\t\t\t\t.append(\"text\")","\t\t\t\t.attr({","\t\t\t\t\t'x' : offsetX / 2,","\t\t\t\t\t'y' : function (d, i) { return svgHeight - ( svgHeight / 4 * i); }","\t\t\t\t//\t'x' : 200,","\t\t\t\t//\t'y' : 200","\t\t\t\t})","\t\t\t\t//.text(\"test\");","\t\t\t\t.text(function(d, i) {return d;});","*/","        });","\t};","","","\t$('#test').click(function() {","//\t\tajaxData();","\t\tajaxTest();","\t});","","\t$('#test2').click(function() {","\t\talert('test2');","\t});","});","",""]},{"action":"insertText","range":{"start":{"row":0,"column":0},"end":{"row":0,"column":96}},"text":"var svgWidth = 1000, svgHeight = 500, barWidth = 50, offsetX = 30, offsetY = 30, barMargin = 30;"},{"action":"insertText","range":{"start":{"row":0,"column":96},"end":{"row":1,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":1,"column":0},"end":{"row":155,"column":0}},"lines":["","// svg","var svg = d3.select('#myGraph')","\t.append('svg')","\t.attr({","\t\t'width' : svgWidth, ","\t\t'height' : svgHeight","\t});","","// 棒グラフ","var barGraph;","","// 折れ線グラフ","var lineGraph;","","// X軸、Y軸","var xLine, yLine;","","// var URL = \"./data.json\";","var URL = \"http://10.211.55.4/wf-log/log/download2\";","","","$(document).ready(function() {","\t\t\t// X軸ライン","\t\t\txLine = svg","\t\t\t\t.append(\"rect\")","\t\t\t\t.attr({","\t\t\t\t\t'width' : svgWidth,","\t\t\t\t\t'height' : 1,","\t\t\t\t\t'transform' : \"translate(\" + 0 + \", \"+ (svgHeight - offsetY) + \")\"","\t\t\t\t});\t\t\t\t","","\t\t\t// Y軸ライン","\t\t\tyLine = svg","\t\t\t\t.append(\"rect\")","\t\t\t\t.attr({","\t\t\t\t\t'width' : 1,","\t\t\t\t\t'height' : svgHeight,","\t\t\t\t\t'transform' : \"translate(\" + offsetX + \", \" + offsetY + \")\"","\t\t\t\t});","","});","","$(function() {","","\tvar ajaxData = function() {","//      \tvar hostUrl = \"http://10.211.55.4/wf-log/log/download3\";","\t\tvar hostUrl = \"./data.json\";","\t\tvar startDt = $('#startDt').val();","\t\tvar endDt   = $('#endDt').val();","","\t\tif (startDt.length != 8 ||","\t\t    endDt.length != 8) {","\t\t\talert('please input date');","\t\t\treturn 0;","\t\t}","\t\t","\t\t$.ajax({","               \t\turl: hostUrl,","               \t\ttype:'GET',","               \t\tdataType: 'json',","\t\t\tcache: false,","\t\t\tdata: {","\t\t\t\tstartDt : startDt,","\t\t\t\tendDt   : endDt","\t\t\t},","                \ttimeout:10000,","                \tsuccess: function(data) {","\t\t\t//\tvar len = data.length;","\t\t\t//\talert(len);","\t\t\t//\tfor (var i = 0 ; i < len ; i++) {","\t\t\t//\t\talert(data[i].week);","\t\t\t//\t}","\t\t\td3paint(data);","\t\t\treturn data;","        \t        },","                \terror: function(XMLHttpRequest, textStatus, errorThrown) {","                        //\t     alert(textStatus);","                       \t}","              });","","\t};","","\tvar d3paint = function(data) {","\t\td3.json(URL, function (data) {","\t\t\t// X軸の描画位置表示\t","\t\t\tvar xPos = function (i) { return i * (barWidth + barMargin) + offsetX;};","","\t\t\t// sizeの最大値","\t\t\tvar maxSize = d3.max(data, function(data) {return data.size;});","\t","\t\t\t// size(棒グラフ)用Y軸表示位置計算関数","\t\t\tvar yScaleSize = d3.scale.linear()","\t\t\t\t.domain([0, maxSize])","\t\t\t\t.range([svgHeight - offsetY, offsetY]);","","\t\t\t// cntの最大値","\t\t\tvar maxCnt = d3.max(data, function(data) {return data.cnt;});","","\t\t\t// cnt(折れ線グラフ)用Y軸表示位置計算関数","\t\t\tvar yScaleCnt = d3.scale.linear()","\t\t\t\t.domain([0, maxCnt])","\t\t\t\t.range([svgHeight - offsetY, offsetY]);","","\t\t\t// 棒グラフを初期化","\t\t\tbarGraph = svg","\t\t\t\t\t\t.selectAll(\"rect\")","\t\t\t\t\t\t.data(data);","","\t\t\t// 棒グラフの描写","\t\t\tbarGraph","\t\t\t\t.enter()","\t\t\t\t.append(\"rect\")","\t\t\t\t.attr({","\t\t\t\t\t'x' : function(d, i) { return xPos(d.week);},","\t\t\t\t\t'y' : function(d, i) { return yScaleSize(d.size);},","\t\t\t\t\t'width' : barWidth,","\t\t\t\t\t'height' : function(d, i) { return svgHeight - yScaleSize(d.size) - offsetY;},","\t\t\t\t\t'fill' : \"#FF0000\"","\t\t\t\t});","","\t\t\t// 折れ線グラフの計算メソッド","\t\t\tvar drawLine = d3.svg.line()","\t\t\t\t\t\t\t.x(function(d, i) { return xPos(d.week) + (barWidth / 2); })","\t\t\t\t\t\t\t.y(function(d, i) { return yScaleCnt(d.cnt);});","","\t\t\tlineGraph = svg","\t\t\t\t\t.append(\"path\")","\t\t\t\t\t.attr({","\t\t\t\t\t\t\"d\" : drawLine(data),","\t\t\t\t\t\t\"fill\" : \"none\",","\t\t\t\t\t\t\"stroke\" : \"#0000FF\"","\t\t\t\t});","","\t\t\t// X軸のラベル","\t\t\txLine","\t\t\t\t.append(\"text\")","\t\t\t\t.attr({","\t\t\t\t\t'x' : function (d, i) { return xPos(d.week); },","\t\t\t\t\t'y' : function (d, i) { return svgHeight - offsetY + 15 }","\t\t\t\t})","\t\t\t\t.text(function(d, i) {return [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\" ][d.week - 1];});","\t\t});","\t};","\t$('#test').click(function() {","\t\tajaxData();","\t});","","\t$('$test2').click(function() {","\t\talert('test2');","\t});","});","",""]}]}]],"redo":[]}},"window":{"left":171,"top":22,"width":1024,"height":675}}